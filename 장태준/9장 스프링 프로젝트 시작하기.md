# 9.3 애플리케이션 아키텍처

## 9.3.1 계층형 아키텍처

서비스 오브젝트들은 특정 기술과 환경에 종속되지 않으면서 도메인의 업무에는 밀접하게 관련을 갖고 있는 POJO로 만들어진다.

성격이 다른 것은 아키텍처 레벨에서 분리해주자.

책임과 성격이 다른 것을 크게 그룹으로 만들어 분리해두는 것을 아키텍처 차원에서는 계층형 아키택처layered architecture라고 한다.

### 3계층 아키텍처와 수직 계층

- 백엔드의 DB나 레거시 시스템과 연동하는 인터페이스 역할을 하는 데이터 액세스 계층
    - DAO 계층
- 비즈니스 로직을 담고 있는 서비스 계층
    - POJO로 작성
- 주로 웹 기반의 UI를 만들어내고 그 흐름을 관리하는 프레젠테이션 계층
    - 프레임워크의 조합

### 계층형 아키텍처 설계의 원칙

각 계층은 자신의 계층의 책임에만 충실해야 한다

스프링의 DI는 기본적으로 오브젝트 사이의 관계를 다룬다 → 계층 사이의 경계나 그 관계에 직접적 관여 X

## 9.3.2 애플리케이션 정보 아키텍처

- 데이터 중심 아키텍처

애플리케이션에 흘러다니는 정보를 단순히 값이나 값을 담기 위한 목적의 오브젝트 형태로 취급하는 구조

- DB/SQL 중심의 로직 구현 방식

데이터 중심 구조 → 하나의 업무 트랜잭션에 모든 계층의 코드가 종속되는 경향

항상 SQL과 그 결과에 종속되기 때문에 SQL의 변화가 일어나면 같이 변경 → 변화에 취약

- 거대한 서비스 계층방식

주요 로직을 서비스 계층에서 처리하도록 거대한 서비스 계층을 만들면 → DAO와 SQL은 간단하지만 일반화 하기 어렵다

데이터 중심 아키텍처의 특정은 계층 사이의 결합도가 높은 편이고 응집도는 떨어진 다는 점이다.

## 9.3.3 오브젝트 중심 아키텍처

도메인 모델을 각 계층 사이에서 정보를 전송하는데 사용

SQL 결과를 담기 위해 급조해서 만든 오브젝트 → 애플리케이션 어디에서도 시용될 수 있는 일관된 형식의 도메인 정보

- 문제점
    - 최적화된 SQL에 비해서는 손해가 있을수 있다
    - 하나의 오브젝트만 필요한데 관계를 갖고 있는 오브젝트도 가져와 손해가 있을 수 있다. → lazy loading으로 해결
    
    > 오브젝트 RDB 매핑 기술인 ORM을 사용하자
    > 
    
- 빈약한 도메인 오브젝트 방식
    
    Data만 가지고 있어 거대 서비스 계층과 유사
    
- 풍성한 도메인 오브젝트 방식
    
    로직을 도메인 오브젝트에 넣기
    
    서비스 계층의 비즈니스 로직에서 재사용
    

### 도메인 계층 방식

도메인 오브젝트들이 하나의 독립적인 계층을 이뤄서 서비스 계층과 데이터 액세스 계층의 사이에 존재하는 것

도메인 오브젝트는 스프링에 등록돼 서 싱글톤으로 관리되는 빈이 아니기 때문에 다른 빈을 DI 받을 수 없다 → DI를 적용하기 위해서는 AOP

## 9.3.4 스프링 애플리케이션을 위한 아키텍처 설계

### 계층형 아키텍처

3계층 구조 - 프레젠테이션, 서비스, 데이터 액세스

프레젠테이션 계층 - SpringMVC

서비스 계층 - POJO로 구현하면서 트랜잭션 AOP를 적용

데이터 액세스 계층 - JDBC를 비롯해서 스프링의 데이터 액세스 전략이 적용된 lPA. 하이벼네이트. JDO 등

### 정보전송아키텍처

오브젝트 중심 아 키텍처의 도메인 오브젝트 방식

### 상태관리와 빈 스코프

`상태 관리`를 신경써야함!

### 스프링이 지원하는 기술이란?

1. 해당 기술을 스프링의 DI패턴을 따라 사용할 수 있다
2. 스프링의 서비스 추상화가 적용됐다
3. 스프링이 지지하는 프로그래밍 모델을 적용했다.
4. 템플릿 / 콜백이 지원된다.